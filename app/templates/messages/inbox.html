{% extends 'base.html' %}

{% block title %}Сообщения — Room2room Tour{% endblock %}

{% block content %}
<div class="d-flex align-items-center mb-3">
  <a href="{{ url_for('account.dashboard') }}" class="btn btn-outline-secondary btn-sm me-3">
    <i class="fa fa-arrow-left"></i> Назад в кабинет
  </a>
  <h1 class="h5 mb-0">Сообщения</h1>
</div>

{% if not peers %}
  <div class="text-muted">Пока нет диалогов.</div>
{% else %}
  <div class="list-group shadow-sm">
    {% for u in peers %}
      <a href="{{ url_for('messages.chat', user_id=u.id) }}" class="list-group-item list-group-item-action d-flex align-items-center justify-content-between flex-wrap gap-2">
        <div class="d-flex align-items-center gap-2">
          <img src="{{ (u.avatar or '')|media or url_for('static', filename='images/avatar-placeholder.svg') }}" class="rounded-circle avatar-nav" alt="" loading="lazy" decoding="async">
          <div class="fw-semibold">{{ u.username }}</div>
        </div>
        {% set count = unread_map.get(u.id) %}
        {% if count %}<span class="badge text-bg-danger">{{ count }}</span>{% endif %}
      </a>
    {% endfor %}
  </div>
{% endif %}
{% endblock %}


